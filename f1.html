<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="keywords" content="F1, formula one, current race, next f1 race, next race, next formula one race, formula one info, f1 info, 2023 f1 race schedule, f1 driver standings, driver standings, constructor standings, f1 driver info, f1 race weekend, f1 ">
    <title>f1.wtf - Current F1 Race Information</title>
    <title>ft.wtf</title>
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
    <link rel="manifest" href="site.webmanifest">
    <!-- Include Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Include Vue.js -->
    <script src="https://unpkg.com/vue@2.6.14"></script>
    <!-- Include Axios for API requests -->
    <script src="https://cdn.jsdelivr.net/npm/axios@0.26.1/dist/axios.min.js"></script>
    <!-- Include Moment.js for date/time manipulation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment-timezone/0.5.34/moment-timezone-with-data.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/luxon@2.3.0/build/global/luxon.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />

<style>
    .h1{
        margin-bottom: 0px;
    }
    .current1{
        padding-left: 0!important;
        margin-left: 0!important;
        display: block;
    }
    .link{
        color: #000;
    }
    .hi{
        text-align: center;
        border-radius: 7px;
        color: #070e03;
    }
    .full-width-btn {
        width: 100%;
        text-align: center;
        font-size: 25px;
        background-color: #00000000;
        padding-left: 0px;
        padding-right: 0px;
        /* background-color: #020f09; */
        /* color: #f7f9f4; */
        /* padding: 0; */
        /* margin: 0; */
    }
    .full-width-btn:not(.collapsed) {
    /* color: #0c63e4; */
    background-color: #00000000;
    color: inherit;
    box-shadow: none; /* remove box-shadow */
    /* box-shadow: inset 0 -1px 0 rgba(0,0,0,.125); */
    }
    .full-width-btn:focus {
        outline: none; /* remove outline */
        box-shadow: none; /* remove box-shadow */
        border-color: transparent; /* remove border-color */
    }
    .full-width-btn:not(.collapsed)::after {
        background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23212529'%3e%3cpath fill-rule='evenodd' d='M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z'/%3e%3c/svg%3e") !important;
    }
    .nah{
        text-align: center;
        color: #070e03;
    }
    .no-padding{
        padding: 0;
        margin: 0;
    }
    .cool_nav{
        background-color: #020f09;
        color: #f7f9f4;
    }

    .cool_brand{
        color: #ffffff;
        
    }
    .cool_brand:hover{
        color: #000000;
    }

    .nice_bg{
        background-color: #f7f9f4;
    }
    .nice_card{
        background-color: #a2554c;
        color: #f7f9f4;
    }
    .nice_color{
        color: #070e03;
    }
    .race_name{
        font-size: 69px;
        margin-bottom: 0px;
    }
    .race_name:hover{
        color: #f7f9f4;
    }
    a:hover{
        color: #020f09;
    }
    .nice_normal_card{
        background-color: #f7f9f4;
    }
    .nice_header{
        background-color: #020f09;
        color: #a2554c;
        border-bottom-left-radius: 5px;
        border-bottom-right-radius: 5px;
        font-weight: 400;
        font-size: 25px;
    }
    .ac_header{
        border-top-left-radius: 5px !important;
        border-top-right-radius: 5px !important;
        /* background-color: #f0f5fe; */
    }
    .info_card_main{
        font-size: 20px;
    }
    .info_card_header{
        font-size: 30px;
    }
    .race_main{
        font-size: 35px;
    }
    .race_header{
        font-size: 50px;
    }
    .race_weekend{
        background-color: #020f09;
        color: #a2554c;
        border-top-left-radius: 5px;
        border-top-right-radius: 5px;
        font-weight: 400;
        font-size: 25px;
        padding: 0px;
    }
    .info_spot{
        background-color: #020f09;
        color: #a2554c;
        border-top-left-radius: 5px;
        border-top-right-radius: 5px;
        font-size: 60px;
        padding: 0px;
        font-weight: 600;
    }
    /* .card-header {
        padding: 0;
    } */
    /* .btn{
        text-align: center;
        color: #fff;
        background-color: #6c757d;
        border-color: #6c757d;
        border-radius: 0.25rem;
    } */
</style>
</head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6QQDGDQG82"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-6QQDGDQG82');
</script>
<body class="nice_bg">
    <div id="app" class="container-fluid nice_bg">
        <!-- ****************************************************************** -->
        <!-- ************************* ~~~ NAVBAR ~~~ ************************* -->
        <!-- ****************************************************************** -->
        <nav class="navbar navbar-expand-lg cool_nav">
            <div class="container-fluid">
                <a class="navbar-brand cool_brand" href="#">f1.wtf</a>
                <!-- <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button> -->
                <div class="nothing" id="navbarNav">
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                        <!-- Add navbar items here -->
                    </ul>
                    <form class="d-flex">
                        <select class="form-select nice_normal_card" id="timezone" class="form-control" v-model="selectedTimeZone" @change="updateTimeNew">
                        <option v-for="zone in timeZones" :value="zone">{{ zone }}</option>
                    </select>
                    </form>
                </div>
            </div>
        </nav>

        <!-- ***************************************************************** -->
        <!-- <div class="text-center card">
            <div class="card-header">
                Next F1 Race
              </div>
            
            <div class="card-body">
                <h1><a :href=url target="_blank" class="link">{{ raceName }}</a></h1>
                <h3>{{ nextRaceLocation }}</h3>
                <hr>
                <p><b>Practice 1:</b> {{ fp1 }}</p>
                <p><b>Practice 2:</b> {{ fp2 }}</p>
                <p><b>Practice 3:</b> {{ fp3 }}</p>
                <p><b>Qualifying:</b> {{ nextQualiTime }}</p>
                <p><b>Sprint:</b> {{ sprint }}</p>
                <p><h2><b>Race:</b> {{ nextRaceTime }}</h2></p>
              </div>

        </div> -->
        <div class="nah">
            <div class="col-md-8 offset-md-2 nice_header">
                Next Race
            </div>
            <h1 class="text-center race_name"> <a :href=url target="_blank" class="link">{{ raceName }}</a></h1>
            <h3 class="text-center mb-4">{{ nextRaceLocation }}</h3>
            <div class="row">
              <div class="col-md-8 offset-md-2">
                <br>
                <div class="list-group">
                    <div class="race_weekend">
                        Race Weekend
                    </div>
                <div class="list-group-item nice_card">
                    <p class="mb-1 race_header">Race</p>
                    <p class="race_main">{{ nextRaceTime }}</p>
                  </div>
                  <!-- <hr> -->
                  <div class="list-group-item nice_normal_card">
                    <p class="mb-1 info_card_header">Practice 1</p>
                    <p class="info_card_main">{{ fp1 }}</p>
                  </div>
                  <div class="list-group-item nice_normal_card">
                    <p class="mb-1 info_card_header">Practice 2</p>
                    <p class="info_card_main">{{ fp2 }}</p>
                  </div>
                  <div v-if="fp3 !== 'none'" class="list-group-item nice_normal_card">
                    <p class="mb-1 info_card_header">Practice 3</p>
                    <p class="info_card_main">{{ fp3 }}</p>
                  </div>
                  <div class="list-group-item nice_normal_card">
                    <p class="mb-1 info_card_header">Qualifying</p>
                    <p class="info_card_main">{{ nextQualiTime }}</p>
                  </div>
                  <div v-if="sprint !== 'none'" class="list-group-item nice_normal_card">
                    <p class="mb-1 info_card_header">Sprint</p>
                    <p class="info_card_main">{{ sprint }}</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        <br>
        <!-- ***************************************************************** -->
        <!-- ********************** ~~~ ACCORDION START ~~~ ****************** -->
        <!-- ***************************************************************** -->
        <div class="col-md-10 offset-md-1 ac_header">
          <div class="accordion" id="accordionExample">
            <div class="hi">
                <!-- <hr> -->
                <div class="info_spot">
                    Info
                </div>
              <div class="card-header" id="headingOne">
                <h5 class="mb-0">
                  <button @click="fetchCurrentSeasonRaces" class="btn collapsed accordion-button full-width-btn" type="button" data-toggle="collapse" data-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
                    2023 Race Schedule
                  </button>
                </h5>
              </div>
          
              <div id="collapseOne" class="collapse" aria-labelledby="headingOne" data-parent="#accordionExample">
                    <div class="text-center">
                        <h1>2023 F1 Races</h1>
                        <table class="table table-striped table-hover">
                            <thead>
                                <tr>
                                    <th @click="sortByRaces('round')" >Round <i class="fas fa-sort"></i></th>
                                    <th @click="sortByRaces('raceName')">Race Name <i class="fas fa-sort"></i></th>
                                    <th @click="sortByRaces('date')">Date <i class="fas fa-sort"></i></th>
                                    <th @click="sortByRaces('time')">Time <i class="fas fa-sort"></i></th>
                                    <th @click="sortByRaces('circuit')">Circuit <i class="fas fa-sort"></i></th>
                                    <th @click="sortByRaces('location')">Location <i class="fas fa-sort"></i></th>
                                    <th @click="sortByRaces('country')">Country <i class="fas fa-sort"></i></th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="race in sortedRaces">
                                    <td>{{ race.round }}</td>
                                    <td>{{ race.raceName }}</td>
                                    <td>{{ convertDateForRace(race.date) }}</td>
                                    <td>{{ convertTimeForRace(race.date, race.time) }}</td>
                                    <td>{{ race.Circuit.circuitName }}</td>
                                    <td>{{ race.Circuit.Location.locality }}</td>
                                    <td>{{ race.Circuit.Location.country }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
              </div>
            </div>
            <div class="hi">
              <div class="card-header" id="headingTwo">
                <h5 class="mb-0">
                  <button @click="fetchDriverStandings" class="btn collapsed accordion-button full-width-btn" type="button" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                    Driver Standings
                  </button>
                </h5>
              </div>
              <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionExample">
                <div class="card-body">
                    <div class="text-center">
                        <h1>F1 Driver Standings</h1>
                        <table class="table table-striped table-hover">
                            <thead>
                                <tr>
                                    <th @click="sortBy('position')">Position <i class="fas fa-sort"></i></th>
                                    <th @click="sortBy('points')">Points <i class="fas fa-sort"></i></th>
                                    <th @click="sortBy('givenName')">First Name <i class="fas fa-sort"></i></th>
                                    <th @click="sortBy('familyName')">Last Name <i class="fas fa-sort"></i></th>
                                    <th @click="sortBy('nationality')">Nationality <i class="fas fa-sort"></i></th>
                                    <th @click="sortBy('constructor')">Constructor <i class="fas fa-sort"></i></th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="driver in sortedDrivers">
                                    <td>
                                        <span v-if="driver.position === '1'">🏆</span>
                                        <span v-else-if="driver.position === '2'">🥈</span>
                                        <span v-else-if="driver.position === '3'">🥉</span>
                                        <span v-else>{{ driver.position }}</span>
                                    </td>
                                    <td>{{ driver.points }}</td>
                                    <td>{{ driver.Driver.givenName }}</td>
                                    <td>{{ driver.Driver.familyName }}</td>
                                    <td>{{ driver.Driver.nationality }}</td>
                                    <td>{{ driver.Constructors[0].name }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
              </div>
            </div>
            <div class="hi">
                <div class="card-header" id="headingThree">
                  <h5 class="mb-0">
                    <button @click="fetchConstructorStandings" class="btn collapsed accordion-button full-width-btn" type="button" data-toggle="collapse" data-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                      Constructor Standings
                    </button>
                  </h5>
                </div>
                <div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#accordionExample">
                  <div class="card-body">
                    <div class="text-center">
                        <h1>F1 Constructor Standings</h1>
                        <table class="table table-striped table-hover">
                            <thead>
                                <tr>
                                    <th @click="sortBy('position')">Position <i class="fas fa-sort"></i></th>
                                    <th @click="sortBy('Constructor')">Constructor <i class="fas fa-sort"></i></th>
                                    <th @click="sortBy('points')">Points <i class="fas fa-sort"></i></th>
                                    <th @click="sortBy('wins')">Wins <i class="fas fa-sort"></i></th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="standing in sortedStandings">
                                    <td>
                                        <span v-if="standing.position === '1'">🏆</span>
                                        <span v-else-if="standing.position === '2'">🥈</span>
                                        <span v-else-if="standing.position === '3'">🥉</span>
                                        <span v-else>{{ standing.position }}</span>
                                    </td>
                                    <!-- <td>{{ standing.position }}</td> -->
                                    <td>{{ standing.Constructor.name }}</td>
                                    <td>{{ standing.points }}</td>
                                    <td>{{ standing.wins }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                  </div>
                </div>
              </div>
            <div class="hi">
              <div class="card-header" id="headingFour">
                <h5 class="mb-0">
                  <button @click="fetchLastRaceResults" class="btn collapsed accordion-button full-width-btn" type="button" data-toggle="collapse" data-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
                    {{ previousRaceName }} Results
                  </button>
                </h5>
              </div>
              <div id="collapseFour" class="collapse" aria-labelledby="headingFour" data-parent="#accordionExample">
                <div class="card-body">
                    <div class="text-center">
                        <h1>{{ previousRaceName }} Results</h1>
                        <table class="table table-striped table-hover">
                            <thead>
                                <tr>
                                    <th @click="sortBy('position')">Position <i class="fas fa-sort"></i></th>
                                    <th @click="sortBy('Driver')">Driver <i class="fas fa-sort"></i></th>
                                    <th @click="sortBy('Constructor')">Constructor <i class="fas fa-sort"></i></th>
                                    <th @click="sortBy('laps')">Laps <i class="fas fa-sort"></i></th>
                                    <th @click="sortBy('status')">Status <i class="fas fa-sort"></i></th>
                                    <th @click="sortBy('points')">Points <i class="fas fa-sort"></i></th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="result in sortedResults">
                                    <td>
                                        <span v-if="result.position === '1'">🏆</span>
                                        <span v-else-if="result.position === '2'">🥈</span>
                                        <span v-else-if="result.position === '3'">🥉</span>
                                        <span v-else>{{ result.position }}</span>
                                    </td>
                                    <td>{{ result.Driver.givenName }} {{ result.Driver.familyName }}</td>
                                    <td>{{ result.Constructor.name }}</td>
                                    <td>{{ result.laps }}</td>
                                    <td>{{ result.status }}</td>
                                    <td>{{ result.points }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
              </div>
            </div>
            <div class="hi">
                <div class="card-header" id="headingFive">
                  <h5 class="mb-0">
                    <button @click="fetchDrivers2" class="btn collapsed accordion-button full-width-btn" type="button" data-toggle="collapse" data-target="#collapseFive" aria-expanded="false" aria-controls="collapseFive">
                      Driver Info
                    </button>
                  </h5>
                </div>
                <div id="collapseFive" class="collapse" aria-labelledby="headingFive" data-parent="#accordionExample">
                  <div class="card-body">
                    <div class="text-center">
                        <h1>F1 Drivers</h1>
                        <table class="table table-striped table-hover">
                            <thead>
                                <tr>
                                    <th @click="sortByDriver('givenName')">Name <i class="fas fa-sort"></i></th>
                                    <th @click="sortByDriver('permanentNumber')">Number <i class="fas fa-sort"></i></th>
                                    <th @click="sortByDriver('nationality')">Nationality <i class="fas fa-sort"></i></th>
                                    <th @click="sortByDriver('dateOfBirth')">Age <i class="fas fa-sort"></i></th>
                                    <th @click="sortByDriver('dateOfBirth')">Date of Birth <i class="fas fa-sort"></i></th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="driver2 in sortedDrivers2">
                                    <td><a :href=driver2.url target="_blank" class="nice_color">{{ driver2.givenName }} {{ driver2.familyName }}</a></td>
                                    <td>{{ driver2.permanentNumber }}</td>
                                    <td>{{ driver2.nationality }}</td>
                                    <td>{{ calculateAge(driver2.dateOfBirth) }}</td>
                                    <td>{{ driver2.dateOfBirth }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                  </div>
                </div>
              </div>
            <!-- *** END ACCORDIAN ******** -->
          </div>
        </div>
<!-- *** END ACCORDIAN ******** -->
    </div>

    <!-- Include main.js -->
    <!-- <script src="main.js"></script> -->
    <script>
        const { DateTime } = luxon;
        function myFunction(that) {
            if(that.classList.contains('btn-primary')){
                that.classList.remove('btn-primary');
                that.classList.add('btn-success');
            } else {
                that.classList.remove('btn-success');
                that.classList.add('btn-primary');
            }
        }
        const API_URL = "https://ergast.com/api/f1/current/next.json";
        const API_URL1 = "https://ergast.com/api/f1/current/driverStandings.json";
        const API_URL2 = "https://ergast.com/api/f1/current.json";
        const API_URL3 = "https://ergast.com/api/f1/current/last/results.json";
        const API_URL4 = "https://ergast.com/api/f1/current/last.json";
        const API_URL5 = "https://ergast.com/api/f1/current/constructorStandings.json";
        const API_URL6 = "https://ergast.com/api/f1/current/drivers.json";

        new Vue({
            el: "#app",
            data: {
                nextRaceLocation: "",
                nextRaceTime: "",
                fp1: "none",
                fp2: "none",
                fp3: "none",
                sprint: "none",
                nextQualiTime: "",
                raceName: "",
                drivers: [],
                sortKey: "",
                sortOrder: 1,
                races: [],
                sortKeyRaces: "",
                sortOrderRaces: 1,
                url: "",
                results: [],
                previousRaceName: "",
                standings: [],
                drivers2: [],
                sortKeyDrivers: "givenName",
                birthdate: '',
                age: null,
                selectedTimeZone: localStorage.getItem("selectedTimeZone") || "America/New_York",
                timeZones: [
                    "America/New_York",
                    "America/Chicago",
                    "America/Denver",
                    "America/Phoenix",
                    "America/Los_Angeles",
                    "America/Anchorage",
                    "America/Adak",
                    "Pacific/Honolulu",
                    "Europe/London",
                    "Europe/Dublin",
                    "Europe/Paris",
                    "Europe/Berlin",
                    "Europe/Madrid",
                    "Europe/Rome",
                    "Europe/Warsaw",
                    "Europe/Athens",
                    "Europe/Istanbul",
                    "Europe/Moscow",
                    "Asia/Tokyo",
                    "Asia/Seoul",
                    "Asia/Shanghai",
                    "Asia/Hong_Kong",
                    "Asia/Singapore",
                    "Asia/Kolkata",
                    "Asia/Dubai",
                    "Asia/Jakarta",
                    "Asia/Manila",
                    "America/Buenos_Aires",
                    "America/Santiago",
                    "America/Lima",
                    "America/Bogota",
                    "America/Caracas",
                    "America/Toronto",
                    "America/Vancouver",
                    "America/Winnipeg",
                    "America/Halifax",
                    "America/St_Johns",
                    "Asia/Riyadh",
                    "Asia/Beirut",
                    "Asia/Tehran",
                    "Asia/Baghdad",
                    "Asia/Jerusalem",
                    "Africa/Cairo",
                    "Africa/Johannesburg",
                    "Africa/Lagos",
                    "Africa/Nairobi",
                    "Africa/Casablanca",
                    "Europe/Stockholm",
                    "Europe/Oslo",
                    "Europe/Copenhagen",
                    "Europe/Helsinki",
                    "Australia/Sydney",
                    "Australia/Melbourne",
                    "Australia/Brisbane",
                    "Australia/Perth",
                    "Australia/Adelaide",
                ],
            },
            computed: {
                sortedDrivers() {
                    if (this.sortKey) {
                        const key = this.sortKey;
                        const order = this.sortOrder;
                        return this.drivers.slice().sort((a, b) => {
                            let aValue = key === "constructor" ? a.Constructors[0].name : a[key] || a.Driver[key];
                            let bValue = key === "constructor" ? b.Constructors[0].name : b[key] || b.Driver[key];

                            if (key === "position" || key === "points") {
                                aValue = parseInt(aValue);
                                bValue = parseInt(bValue);
                            }

                            if (typeof aValue === "string") {
                                return order * aValue.localeCompare(bValue);
                            }
                            return order * (aValue - bValue);
                        });
                    }
                    return this.drivers;
                },
                sortedRaces() {
                    if (this.sortKeyRaces) {
                        const key = this.sortKeyRaces;
                        const order = this.sortOrderRaces;
                        return this.races.slice().sort((a, b) => {
                            let aValue = key === "circuit" ? a.Circuit.circuitName :
                                        key === "location" ? a.Circuit.Location.locality :
                                        key === "country" ? a.Circuit.Location.country :
                                        a[key];
                            let bValue = key === "circuit" ? b.Circuit.circuitName :
                                        key === "location" ? b.Circuit.Location.locality :
                                        key === "country" ? b.Circuit.Location.country :
                                        b[key];

                            if (key === "round") {
                                aValue = parseInt(aValue);
                                bValue = parseInt(bValue);
                            }

                            if (typeof aValue === "string") {
                                return order * aValue.localeCompare(bValue);
                            }
                            return order * (aValue - bValue);
                        });
                    }
                    return this.races;
                },
                sortedResults() {
                    if (this.sortKey) {
                        const key = this.sortKey;
                        const order = this.sortOrder;
                        return this.results.slice().sort((a, b) => {
                            let aValue = key === "Driver" ? a.Driver.familyName :
                                        key === "Constructor" ? a.Constructor.name :
                                        a[key];
                            let bValue = key === "Driver" ? b.Driver.familyName :
                                        key === "Constructor" ? b.Constructor.name :
                                        b[key];

                            if (key === "position" || key === "laps" || key === "points") {
                                aValue = parseInt(aValue);
                                bValue = parseInt(bValue);
                            }

                            if (typeof aValue === "string") {
                                return order * aValue.localeCompare(bValue);
                            }
                            return order * (aValue - bValue);
                        });
                    }
                    return this.results;
                },
                sortedStandings() {
                    if (this.sortKey) {
                        const key = this.sortKey;
                        const order = this.sortOrder;
                        return this.standings.slice().sort((a, b) => {
                            let aValue = key === "Constructor" ? a.Constructor.name : a[key];
                            let bValue = key === "Constructor" ? b.Constructor.name : b[key];

                            if (key === "position" || key === "points" || key === "wins") {
                                aValue = parseInt(aValue);
                                bValue = parseInt(bValue);
                            }

                            if (typeof aValue === "string") {
                                return order * aValue.localeCompare(bValue);
                            }
                            return order * (aValue - bValue);
                        });
                    }
                    return this.standings;

                },
                sortedDrivers2() {
                    if (this.sortKeyDrivers) {
                        const key = this.sortKeyDrivers;
                        const order = this.sortOrder;
                        return this.drivers2.slice().sort((a, b) => {
                            let aValue = key === "givenName" ? a.familyName :
                                        key === "Constructor" ? a.Constructor.name :
                                        a[key];
                            let bValue = key === "givenName" ? b.familyName :
                                        key === "Constructor" ? b.Constructor.name :
                                        b[key];
                            // let aValue = a[key];
                            // let bValue = b[key];
                            
                            if (key === "permanentNumber") {
                                aValue = parseInt(aValue);
                                bValue = parseInt(bValue);
                            }

                            if (key === "dateOfBirth") {
                                aValue = new Date(aValue);
                                bValue = new Date(bValue);
                            }

                            if (typeof aValue === "string") {
                                return order * aValue.localeCompare(bValue);
                            }
                            return order * (aValue - bValue);
                        });
                    }
                    return this.drivers2;
                },
            },
            watch: {
                selectedTimeZone(newValue) {
                localStorage.setItem("selectedTimeZone", newValue);
                },
            },
            mounted() {
                this.fetchNextF1Race();
                // this.fetchDriverStandings();
                // this.fetchCurrentSeasonRaces();
                // this.fetchLastRaceResults();
                this.fetchLastRaceInfo();
                this.resetStuff();
                // this.fetchConstructorStandings();
                // this.fetchDrivers2();
            },
            methods: {
                fetchNextF1Race() {
                    axios.get(API_URL)
                        .then(response => {
                            const nextRace = response.data.MRData.RaceTable.Races[0];
                            this.nextRaceLocation = `${nextRace.Circuit.Location.locality}, ${nextRace.Circuit.Location.country}`;
                            const raceTimeUTC = nextRace.date + "T" + nextRace.time.slice(0, -1);
                            this.nextRaceTime = this.convertZtoCST(raceTimeUTC);
                            const qualiTimeUTC = nextRace.Qualifying.date + "T" + nextRace.Qualifying.time.slice(0, -1);
                            this.nextQualiTime = this.convertZtoCST(qualiTimeUTC);
                            this.raceName = nextRace.raceName;
                            this.url = nextRace.url;
                            const fp1TimeUTC = nextRace.FirstPractice.date + "T" + nextRace.FirstPractice.time.slice(0, -1);
                            this.fp1 = this.convertZtoCST(fp1TimeUTC);
                            const fp2TimeUTC = nextRace.SecondPractice.date + "T" + nextRace.SecondPractice.time.slice(0, -1);
                            this.fp2 = this.convertZtoCST(fp2TimeUTC);
                            if (nextRace.ThirdPractice !== undefined) {
                                const fp3TimeUTC = nextRace.ThirdPractice.date + "T" + nextRace.ThirdPractice.time.slice(0, -1);
                                this.fp3 = this.convertZtoCST(fp3TimeUTC);
                            }
                            if (nextRace.Sprint !== undefined) {
                                const sprintTimeUTC = nextRace.Sprint.date + "T" + nextRace.Sprint.time.slice(0, -1);
                                this.sprint = this.convertZtoCST(sprintTimeUTC);
                            }
                        })
                        .catch(error => {
                            console.error("Error fetching race data:", error);
                        });
                },
                convertZtoCST(zTime) {
                    d = DateTime.fromISO(zTime+"Z");
                    dWZone = d.setZone(this.selectedTimeZone);
                    formattedDate = dWZone.toLocaleString(DateTime.DATETIME_FULL);
                    return formattedDate;
                },
                fetchDriverStandings() {
                    axios.get(API_URL1)
                        .then(response => {
                            this.drivers = response.data.MRData.StandingsTable.StandingsLists[0].DriverStandings;
                        })
                        .catch(error => {
                            console.error("Error fetching driver standings data:", error);
                        });
                },
                fetchCurrentSeasonRaces() {
                    axios.get(API_URL2)
                        .then(response => {
                            this.races = response.data.MRData.RaceTable.Races;
                        })
                        .catch(error => {
                            console.error("Error fetching current season races data:", error);
                        });
                },
                sortBy(key) {
                    if (this.sortKey === key) {
                        this.sortOrder = -this.sortOrder;
                    } else {
                        this.sortKey = key;
                        this.sortOrder = 1;
                    }
                },
                sortByRaces(key) {
                    if (this.sortKeyRaces === key) {
                        this.sortOrderRaces = -this.sortOrderRaces;
                    } else {
                        this.sortKeyRaces = key;
                        this.sortOrderRaces = 1;
                    }
                },
                fetchLastRaceResults() {
                    axios.get(API_URL3)
                        .then(response => {
                            this.results = response.data.MRData.RaceTable.Races[0].Results;
                        })
                        .catch(error => {
                            console.error("Error fetching last race results data:", error);
                        });
                },
                fetchLastRaceInfo() {
                    axios.get(API_URL4)
                        .then(response => {
                            const nextRace = response.data.MRData.RaceTable.Races[0];
                            this.previousRaceName = nextRace.raceName;
                        })
                        .catch(error => {
                            console.error("Error fetching race data:", error);
                        });
                },
                fetchConstructorStandings() {
                    axios.get(API_URL5)
                        .then(response => {
                            this.standings = response.data.MRData.StandingsTable.StandingsLists[0].ConstructorStandings;
                        })
                        .catch(error => {
                            console.error("Error fetching constructor standings data:", error);
                        });
                },
                fetchDrivers2() {
                    axios.get(API_URL6)
                        .then(response => {
                            this.drivers2 = response.data.MRData.DriverTable.Drivers;
                        })
                        .catch(error => {
                            console.error("Error fetching drivers data:", error);
                        });
                },
                sortByDriver(key) {
                    if (this.sortKeyDrivers === key) {
                        this.sortOrder = -this.sortOrder;
                    } else {
                        this.sortKeyDrivers = key;
                        this.sortOrder = 1;
                    }
                },
                updateTimeNew() {
                    const tz = localStorage.getItem("selectedTimeZone");
                    if (tz) {
                        localStorage.setItem("previousTimeZone", tz);
                    }
                    else{
                        // need to set tz and prevtz
                        localStorage.setItem("previousTimeZone", "America/New_York");
                        
                    }
                    const prevTZ = localStorage.getItem("previousTimeZone");
                    const convertTime = (timeStr, prevTZ, newTZ) => {
                        const correctedTime = timeStr.replace(/\s\S+$/, ' ' + prevTZ);
                        const formatString = "LLLL d, yyyy 'at' h:mm a z";
                        const dateTime = DateTime.fromFormat(correctedTime, formatString);
                        return dateTime.setZone(newTZ).toLocaleString(DateTime.DATETIME_FULL);
                    };

                    (this.nextRaceTime !=="none") ? this.nextRaceTime = convertTime(this.nextRaceTime, prevTZ, this.selectedTimeZone) : this.nextRaceTime = "none";
                    (this.nextQualiTime !=="none") ? this.nextQualiTime = convertTime(this.nextQualiTime, prevTZ, this.selectedTimeZone) : this.nextQualiTime = "none";
                    (this.fp1 !=="none") ? this.fp1 = convertTime(this.fp1, prevTZ, this.selectedTimeZone) : this.fp1 = "none";
                    (this.fp2 !=="none") ? this.fp2 = convertTime(this.fp2, prevTZ, this.selectedTimeZone) : this.fp2 = "none";
                    (this.fp3 !== "none") ? this.fp3 = convertTime(this.fp3, prevTZ, this.selectedTimeZone) : this.fp3 = "none";
                    (this.sprint !== "none") ? this.sprint = convertTime(this.sprint, prevTZ, this.selectedTimeZone) : this.sprint = "none";
                },
                resetStuff(){
                localStorage.setItem("previousTimeZone", "");
                },
                convertDateForRace(date) {
                    return DateTime.fromISO(date).setZone(this.selectedTimeZone).toLocaleString(DateTime.DATE_FULL);
                },
                convertTimeForRace(date, time) {
                    return DateTime.fromISO(date + "T" + time).setZone(this.selectedTimeZone).toLocaleString(DateTime.TIME_SIMPLE);
                },
                calculateAge: function(dateString) {
                const birthdate = new Date(dateString);
                const today = new Date();
                let age = today.getFullYear() - birthdate.getFullYear();
                const monthDifference = today.getMonth() - birthdate.getMonth();

                if (monthDifference < 0 || (monthDifference === 0 && today.getDate() < birthdate.getDate())) {
                    age--;
                }

                return age;
                },
            },
        });

    </script>
</body>
</html>
