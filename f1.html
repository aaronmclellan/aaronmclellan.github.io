<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ft.wtf</title>
    <!-- Include Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Include Vue.js -->
    <script src="https://unpkg.com/vue@2.6.14"></script>
    <!-- Include Axios for API requests -->
    <script src="https://cdn.jsdelivr.net/npm/axios@0.26.1/dist/axios.min.js"></script>
    <!-- Include Moment.js for date/time manipulation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment-timezone/0.5.34/moment-timezone-with-data.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/luxon@2.3.0/build/global/luxon.min.js"></script>
<style>
    .current1{
        padding-left: 0!important;
        margin-left: 0!important;
        display: block;
    }
    .link{
        color: #000;
    }
    .hi{
        text-align: center;
        border-radius: 0.25rem;
    }
    /* .btn{
        text-align: center;
        color: #fff;
        background-color: #6c757d;
        border-color: #6c757d;
        border-radius: 0.25rem;
    } */
</style>
</head>
<body>
    <div id="app" class="container-fluid">
        <!-- ***************************************************************** -->
        <!-- ************************* ~~~ NAVBAR ~~~ ************************* -->
        <!-- ***************************************************************** -->
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <div class="container-fluid">
                <a class="navbar-brand" href="#">f1.wtf</a>
                <!-- <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button> -->
                <div class="nothing" id="navbarNav">
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                        <!-- Add navbar items here -->
                    </ul>
                    <form class="d-flex">
                        <select class="form-select" id="timezone" class="form-control" v-model="selectedTimeZone" @change="updateTimeNew">
                        <option v-for="zone in timeZones" :value="zone">{{ zone }}</option>
                    </select>
                    </form>
                </div>
            </div>
        </nav>

        <!-- ***************************************************************** -->
        <div class="text-center card">
            <div class="card-header">
                Next F1 Race
              </div>
            <!-- <h1>Next F1 Race Info</h1> -->
            <div class="card-body">
                <h1><a :href=url target="_blank" class="link">{{ raceName }}</a></h1>
                <h3>{{ nextRaceLocation }}</h3>
                <hr>
                <p><b>Practice 1:</b> {{ fp1 }}</p>
                <p><b>Practice 2:</b> {{ fp2 }}</p>
                <p><b>Practice 3:</b> {{ fp3 }}</p>
                <p><b>Qualifying:</b> {{ nextQualiTime }}</p>
                <p><b>Sprint:</b> {{ sprint }}</p>
                <p><b>Race:</b> {{ nextRaceTime }}</p>
              </div>

        </div>
        <br>
        <!-- ***************************************************************** -->
        <!-- ********************** ~~~ ACCORDION START ~~~ ****************** -->
        <!-- ***************************************************************** -->
          <div class="accordion" id="accordionExample">
            <div class="hi">
              <div class="card-header" id="headingOne">
                <h5 class="mb-0">
                  <button @click="fetchCurrentSeasonRaces" class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
                    2023 Race Schedule
                  </button>
                </h5>
              </div>
          
              <div id="collapseOne" class="collapse" aria-labelledby="headingOne" data-parent="#accordionExample">
                    <div class="text-center">
                        <h1>2023 F1 Races</h1>
                        <table class="table table-striped table-hover">
                            <thead>
                                <tr>
                                    <th @click="sortByRaces('round')">Round</th>
                                    <th @click="sortByRaces('raceName')">Race Name</th>
                                    <th @click="sortByRaces('date')">Date</th>
                                    <th @click="sortByRaces('time')">Time</th>
                                    <th @click="sortByRaces('circuit')">Circuit</th>
                                    <th @click="sortByRaces('location')">Location</th>
                                    <th @click="sortByRaces('country')">Country</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="race in sortedRaces">
                                    <td>{{ race.round }}</td>
                                    <td>{{ race.raceName }}</td>
                                    <td>{{ convertDateForRace(race.date) }}</td>
                                    <td>{{ convertTimeForRace(race.date, race.time) }}</td>
                                    <td>{{ race.Circuit.circuitName }}</td>
                                    <td>{{ race.Circuit.Location.locality }}</td>
                                    <td>{{ race.Circuit.Location.country }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
              </div>
            </div>
            <div class="hi">
              <div class="card-header" id="headingTwo">
                <h5 class="mb-0">
                  <button @click="fetchDriverStandings" class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                    Driver Standings
                  </button>
                </h5>
              </div>
              <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionExample">
                <div class="card-body">
                    <div class="text-center">
                        <h1>F1 Driver Standings</h1>
                        <table class="table table-striped table-hover">
                            <thead>
                                <tr>
                                    <th @click="sortBy('position')">Position</th>
                                    <th @click="sortBy('points')">Points</th>
                                    <th @click="sortBy('givenName')">First Name</th>
                                    <th @click="sortBy('familyName')">Last Name</th>
                                    <th @click="sortBy('nationality')">Nationality</th>
                                    <th @click="sortBy('constructor')">Constructor</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="driver in sortedDrivers">
                                    <td>
                                        <span v-if="driver.position === '1'">üèÜ</span>
                                        <span v-else-if="driver.position === '2'">ü•à</span>
                                        <span v-else-if="driver.position === '3'">ü•â</span>
                                        <span v-else>{{ driver.position }}</span>
                                    </td>
                                    <td>{{ driver.points }}</td>
                                    <td>{{ driver.Driver.givenName }}</td>
                                    <td>{{ driver.Driver.familyName }}</td>
                                    <td>{{ driver.Driver.nationality }}</td>
                                    <td>{{ driver.Constructors[0].name }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
              </div>
            </div>
            <div class="hi">
                <div class="card-header" id="headingThree">
                  <h5 class="mb-0">
                    <button @click="fetchConstructorStandings" class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                      Constructor Standings
                    </button>
                  </h5>
                </div>
                <div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#accordionExample">
                  <div class="card-body">
                    <div class="text-center">
                        <h1>F1 Constructor Standings</h1>
                        <table class="table table-striped table-hover">
                            <thead>
                                <tr>
                                    <th @click="sortBy('position')">Position</th>
                                    <th @click="sortBy('Constructor')">Constructor</th>
                                    <th @click="sortBy('points')">Points</th>
                                    <th @click="sortBy('wins')">Wins</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="standing in sortedStandings">
                                    <td>{{ standing.position }}</td>
                                    <td>{{ standing.Constructor.name }}</td>
                                    <td>{{ standing.points }}</td>
                                    <td>{{ standing.wins }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                  </div>
                </div>
              </div>
            <div class="hi">
              <div class="card-header" id="headingFour">
                <h5 class="mb-0">
                  <button @click="fetchLastRaceResults" class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
                    {{ previousRaceName }} Results
                  </button>
                </h5>
              </div>
              <div id="collapseFour" class="collapse" aria-labelledby="headingFour" data-parent="#accordionExample">
                <div class="card-body">
                    <div class="text-center">
                        <h1>{{ previousRaceName }} Results</h1>
                        <table class="table table-striped table-hover">
                            <thead>
                                <tr>
                                    <th @click="sortBy('position')">Position</th>
                                    <th @click="sortBy('Driver')">Driver</th>
                                    <th @click="sortBy('Constructor')">Constructor</th>
                                    <th @click="sortBy('laps')">Laps</th>
                                    <th @click="sortBy('status')">Status</th>
                                    <th @click="sortBy('points')">Points</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="result in sortedResults">
                                    <td>
                                        <span v-if="result.position === '1'">üèÜ</span>
                                        <span v-else-if="result.position === '2'">ü•à</span>
                                        <span v-else-if="result.position === '3'">ü•â</span>
                                        <span v-else>{{ result.position }}</span>
                                    </td>
                                    <td>{{ result.Driver.givenName }} {{ result.Driver.familyName }}</td>
                                    <td>{{ result.Constructor.name }}</td>
                                    <td>{{ result.laps }}</td>
                                    <td>{{ result.status }}</td>
                                    <td>{{ result.points }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
              </div>
            </div>
            <div class="hi">
                <div class="card-header" id="headingFive">
                  <h5 class="mb-0">
                    <button @click="fetchDrivers2" class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseFive" aria-expanded="false" aria-controls="collapseFive">
                      Driver Info
                    </button>
                  </h5>
                </div>
                <div id="collapseFive" class="collapse" aria-labelledby="headingFive" data-parent="#accordionExample">
                  <div class="card-body">
                    <div class="text-center">
                        <h1>F1 Drivers</h1>
                        <table class="table table-striped table-hover">
                            <thead>
                                <tr>
                                    <th @click="sortByDriver('givenName')">Name</th>
                                    <th @click="sortByDriver('permanentNumber')">Number</th>
                                    <th @click="sortByDriver('nationality')">Nationality</th>
                                    <th @click="sortByDriver('dateOfBirth')">Date of Birth</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="driver2 in sortedDrivers2">
                                    <td><a :href=driver2.url target="_blank">{{ driver2.givenName }} {{ driver2.familyName }}</a></td>
                                    <td>{{ driver2.permanentNumber }}</td>
                                    <td>{{ driver2.nationality }}</td>
                                    <td>{{ driver2.dateOfBirth }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                  </div>
                </div>
              </div>
            <!-- *** END ACCORDIAN ******** -->
          </div>
<!-- *** END ACCORDIAN ******** -->
    </div>

    <!-- Include main.js -->
    <!-- <script src="main.js"></script> -->
    <script>
        const { DateTime } = luxon;
        function myFunction(that) {
            if(that.classList.contains('btn-primary')){
                that.classList.remove('btn-primary');
                that.classList.add('btn-success');
            } else {
                that.classList.remove('btn-success');
                that.classList.add('btn-primary');
            }
        }
        const API_URL = "https://ergast.com/api/f1/current/next.json";
        const API_URL1 = "https://ergast.com/api/f1/current/driverStandings.json";
        const API_URL2 = "https://ergast.com/api/f1/current.json";
        const API_URL3 = "https://ergast.com/api/f1/current/last/results.json";
        const API_URL4 = "https://ergast.com/api/f1/current/last.json";
        const API_URL5 = "https://ergast.com/api/f1/current/constructorStandings.json";
        const API_URL6 = "https://ergast.com/api/f1/current/drivers.json";

        new Vue({
            el: "#app",
            data: {
                nextRaceLocation: "",
                nextRaceTime: "",
                fp1: "none",
                fp2: "none",
                fp3: "none",
                sprint: "none",
                nextQualiTime: "",
                raceName: "",
                drivers: [],
                sortKey: "",
                sortOrder: 1,
                races: [],
                sortKeyRaces: "",
                sortOrderRaces: 1,
                url: "",
                results: [],
                previousRaceName: "",
                standings: [],
                drivers2: [],
                sortKeyDrivers: "givenName",
                selectedTimeZone: localStorage.getItem("selectedTimeZone") || "America/New_York",
                timeZones: [
                    "America/New_York",
                    "America/Chicago",
                    "America/Denver",
                    "America/Phoenix",
                    "America/Los_Angeles",
                    "America/Anchorage",
                    "America/Adak",
                    "Pacific/Honolulu",
                    "Europe/London",
                    "Europe/Dublin",
                    "Europe/Paris",
                    "Europe/Berlin",
                    "Europe/Madrid",
                    "Europe/Rome",
                    "Europe/Warsaw",
                    "Europe/Athens",
                    "Europe/Istanbul",
                    "Europe/Moscow",
                    "Asia/Tokyo",
                    "Asia/Seoul",
                    "Asia/Shanghai",
                    "Asia/Hong_Kong",
                    "Asia/Singapore",
                    "Asia/Kolkata",
                    "Asia/Dubai",
                    "Asia/Jakarta",
                    "Asia/Manila",
                    "America/Buenos_Aires",
                    "America/Santiago",
                    "America/Lima",
                    "America/Bogota",
                    "America/Caracas",
                    "America/Toronto",
                    "America/Vancouver",
                    "America/Winnipeg",
                    "America/Halifax",
                    "America/St_Johns",
                    "Asia/Riyadh",
                    "Asia/Beirut",
                    "Asia/Tehran",
                    "Asia/Baghdad",
                    "Asia/Jerusalem",
                    "Africa/Cairo",
                    "Africa/Johannesburg",
                    "Africa/Lagos",
                    "Africa/Nairobi",
                    "Africa/Casablanca",
                    "Europe/Stockholm",
                    "Europe/Oslo",
                    "Europe/Copenhagen",
                    "Europe/Helsinki",
                    "Australia/Sydney",
                    "Australia/Melbourne",
                    "Australia/Brisbane",
                    "Australia/Perth",
                    "Australia/Adelaide",
                ],
            },
            computed: {
                sortedDrivers() {
                    if (this.sortKey) {
                        const key = this.sortKey;
                        const order = this.sortOrder;
                        return this.drivers.slice().sort((a, b) => {
                            let aValue = key === "constructor" ? a.Constructors[0].name : a[key] || a.Driver[key];
                            let bValue = key === "constructor" ? b.Constructors[0].name : b[key] || b.Driver[key];

                            if (key === "position" || key === "points") {
                                aValue = parseInt(aValue);
                                bValue = parseInt(bValue);
                            }

                            if (typeof aValue === "string") {
                                return order * aValue.localeCompare(bValue);
                            }
                            return order * (aValue - bValue);
                        });
                    }
                    return this.drivers;
                },
                sortedRaces() {
                    if (this.sortKeyRaces) {
                        const key = this.sortKeyRaces;
                        const order = this.sortOrderRaces;
                        return this.races.slice().sort((a, b) => {
                            let aValue = key === "circuit" ? a.Circuit.circuitName :
                                        key === "location" ? a.Circuit.Location.locality :
                                        key === "country" ? a.Circuit.Location.country :
                                        a[key];
                            let bValue = key === "circuit" ? b.Circuit.circuitName :
                                        key === "location" ? b.Circuit.Location.locality :
                                        key === "country" ? b.Circuit.Location.country :
                                        b[key];

                            if (key === "round") {
                                aValue = parseInt(aValue);
                                bValue = parseInt(bValue);
                            }

                            if (typeof aValue === "string") {
                                return order * aValue.localeCompare(bValue);
                            }
                            return order * (aValue - bValue);
                        });
                    }
                    return this.races;
                },
                sortedResults() {
                    if (this.sortKey) {
                        const key = this.sortKey;
                        const order = this.sortOrder;
                        return this.results.slice().sort((a, b) => {
                            let aValue = key === "Driver" ? a.Driver.familyName :
                                        key === "Constructor" ? a.Constructor.name :
                                        a[key];
                            let bValue = key === "Driver" ? b.Driver.familyName :
                                        key === "Constructor" ? b.Constructor.name :
                                        b[key];

                            if (key === "position" || key === "laps" || key === "points") {
                                aValue = parseInt(aValue);
                                bValue = parseInt(bValue);
                            }

                            if (typeof aValue === "string") {
                                return order * aValue.localeCompare(bValue);
                            }
                            return order * (aValue - bValue);
                        });
                    }
                    return this.results;
                },
                sortedStandings() {
                    if (this.sortKey) {
                        const key = this.sortKey;
                        const order = this.sortOrder;
                        return this.standings.slice().sort((a, b) => {
                            let aValue = key === "Constructor" ? a.Constructor.name : a[key];
                            let bValue = key === "Constructor" ? b.Constructor.name : b[key];

                            if (key === "position" || key === "points" || key === "wins") {
                                aValue = parseInt(aValue);
                                bValue = parseInt(bValue);
                            }

                            if (typeof aValue === "string") {
                                return order * aValue.localeCompare(bValue);
                            }
                            return order * (aValue - bValue);
                        });
                    }
                    return this.standings;

                },
                sortedDrivers2() {
                    if (this.sortKeyDrivers) {
                        const key = this.sortKeyDrivers;
                        const order = this.sortOrder;
                        return this.drivers2.slice().sort((a, b) => {
                            let aValue = key === "givenName" ? a.familyName :
                                        key === "Constructor" ? a.Constructor.name :
                                        a[key];
                            let bValue = key === "givenName" ? b.familyName :
                                        key === "Constructor" ? b.Constructor.name :
                                        b[key];
                            // let aValue = a[key];
                            // let bValue = b[key];
                            
                            if (key === "permanentNumber") {
                                aValue = parseInt(aValue);
                                bValue = parseInt(bValue);
                            }

                            if (key === "dateOfBirth") {
                                aValue = new Date(aValue);
                                bValue = new Date(bValue);
                            }

                            if (typeof aValue === "string") {
                                return order * aValue.localeCompare(bValue);
                            }
                            return order * (aValue - bValue);
                        });
                    }
                    return this.drivers2;
                },
            },
            watch: {
                selectedTimeZone(newValue) {
                localStorage.setItem("selectedTimeZone", newValue);
                },
            },
            mounted() {
                this.fetchNextF1Race();
                // this.fetchDriverStandings();
                // this.fetchCurrentSeasonRaces();
                // this.fetchLastRaceResults();
                this.fetchLastRaceInfo();
                this.resetStuff();
                // this.fetchConstructorStandings();
                // this.fetchDrivers2();
            },
            methods: {
                fetchNextF1Race() {
                    axios.get(API_URL)
                        .then(response => {
                            const nextRace = response.data.MRData.RaceTable.Races[0];
                            this.nextRaceLocation = `${nextRace.Circuit.Location.locality}, ${nextRace.Circuit.Location.country}`;
                            const raceTimeUTC = nextRace.date + "T" + nextRace.time.slice(0, -1);
                            this.nextRaceTime = this.convertZtoCST(raceTimeUTC);
                            const qualiTimeUTC = nextRace.Qualifying.date + "T" + nextRace.Qualifying.time.slice(0, -1);
                            this.nextQualiTime = this.convertZtoCST(qualiTimeUTC);
                            this.raceName = nextRace.raceName;
                            this.url = nextRace.url;
                            const fp1TimeUTC = nextRace.FirstPractice.date + "T" + nextRace.FirstPractice.time.slice(0, -1);
                            this.fp1 = this.convertZtoCST(fp1TimeUTC);
                            const fp2TimeUTC = nextRace.SecondPractice.date + "T" + nextRace.SecondPractice.time.slice(0, -1);
                            this.fp2 = this.convertZtoCST(fp2TimeUTC);
                            if (nextRace.ThirdPractice !== undefined) {
                                const fp3TimeUTC = nextRace.ThirdPractice.date + "T" + nextRace.ThirdPractice.time.slice(0, -1);
                                this.fp3 = this.convertZtoCST(fp3TimeUTC);
                            }
                            if (nextRace.Sprint !== undefined) {
                                const sprintTimeUTC = nextRace.Sprint.date + "T" + nextRace.Sprint.time.slice(0, -1);
                                this.sprint = this.convertZtoCST(sprintTimeUTC);
                            }
                        })
                        .catch(error => {
                            console.error("Error fetching race data:", error);
                        });
                },
                convertZtoCST(zTime) {
                    // console.log(zTime);
                    // // Create a Date object from the input time string
                    // const utcDate = new Date(zTime);

                    // // Set the target timezone (CST) offset in hours
                    // const cstOffset = -5;

                    // // Calculate the target timezone (CST) time by applying the offset
                    // const cstDate = new Date(utcDate.getTime() + (cstOffset * 60 * 60 * 1000));

                    // // Format the date and time for display
                    // const options = {
                    //     timeZone: 'America/Chicago',
                    //     year: 'numeric',
                    //     month: '2-digit',
                    //     day: '2-digit',
                    //     hour: '2-digit',
                    //     minute: '2-digit',
                    //     second: '2-digit',
                    // };
                    // const formattedDate = cstDate.toLocaleString('en-US', options);
                    d = DateTime.fromISO(zTime+"Z");
                    dWZone = d.setZone(this.selectedTimeZone);
                    formattedDate = dWZone.toLocaleString(DateTime.DATETIME_FULL);
                    return formattedDate;
                },
                fetchDriverStandings() {
                    axios.get(API_URL1)
                        .then(response => {
                            this.drivers = response.data.MRData.StandingsTable.StandingsLists[0].DriverStandings;
                        })
                        .catch(error => {
                            console.error("Error fetching driver standings data:", error);
                        });
                },
                fetchCurrentSeasonRaces() {
                    axios.get(API_URL2)
                        .then(response => {
                            this.races = response.data.MRData.RaceTable.Races;
                        })
                        .catch(error => {
                            console.error("Error fetching current season races data:", error);
                        });
                },
                sortBy(key) {
                    if (this.sortKey === key) {
                        this.sortOrder = -this.sortOrder;
                    } else {
                        this.sortKey = key;
                        this.sortOrder = 1;
                    }
                },
                sortByRaces(key) {
                    if (this.sortKeyRaces === key) {
                        this.sortOrderRaces = -this.sortOrderRaces;
                    } else {
                        this.sortKeyRaces = key;
                        this.sortOrderRaces = 1;
                    }
                },
                fetchLastRaceResults() {
                    axios.get(API_URL3)
                        .then(response => {
                            this.results = response.data.MRData.RaceTable.Races[0].Results;
                        })
                        .catch(error => {
                            console.error("Error fetching last race results data:", error);
                        });
                },
                fetchLastRaceInfo() {
                    axios.get(API_URL4)
                        .then(response => {
                            const nextRace = response.data.MRData.RaceTable.Races[0];
                            this.previousRaceName = nextRace.raceName;
                        })
                        .catch(error => {
                            console.error("Error fetching race data:", error);
                        });
                },
                fetchConstructorStandings() {
                    axios.get(API_URL5)
                        .then(response => {
                            this.standings = response.data.MRData.StandingsTable.StandingsLists[0].ConstructorStandings;
                        })
                        .catch(error => {
                            console.error("Error fetching constructor standings data:", error);
                        });
                },
                fetchDrivers2() {
                    axios.get(API_URL6)
                        .then(response => {
                            this.drivers2 = response.data.MRData.DriverTable.Drivers;
                        })
                        .catch(error => {
                            console.error("Error fetching drivers data:", error);
                        });
                },
                sortByDriver(key) {
                    if (this.sortKeyDrivers === key) {
                        this.sortOrder = -this.sortOrder;
                    } else {
                        this.sortKeyDrivers = key;
                        this.sortOrder = 1;
                    }
                },
                updateTimeNew() {
                    const tz = localStorage.getItem("selectedTimeZone");
                    if(tz){
                    localStorage.setItem("previousTimeZone", tz);
                    }
                    
                    // convert static time
                    const prevTZ = localStorage.getItem("previousTimeZone");
                    correctedDateString = this.nextRaceTime.replace(/\s\S+$/, ' '+prevTZ);

                    const formatString = "LLLL d, yyyy 'at' h:mm a z";
                    const d = DateTime.fromFormat(correctedDateString, formatString);
                    
                    const dWZone = d.setZone(this.selectedTimeZone);
                    this.nextRaceTime = dWZone.toLocaleString(DateTime.DATETIME_FULL);

                    correctedQualiTime = this.nextQualiTime.replace(/\s\S+$/, ' '+prevTZ);
                    const d1 = DateTime.fromFormat(correctedQualiTime, formatString);
                    const dWZone1 = d1.setZone(this.selectedTimeZone);
                    this.nextQualiTime = dWZone1.toLocaleString(DateTime.DATETIME_FULL);

                    correctedFp1 = this.fp1.replace(/\s\S+$/, ' '+prevTZ);
                    const d2 = DateTime.fromFormat(correctedFp1, formatString);
                    const dWZone2 = d2.setZone(this.selectedTimeZone);
                    this.fp1 = dWZone2.toLocaleString(DateTime.DATETIME_FULL);

                    correctedFp2 = this.fp2.replace(/\s\S+$/, ' '+prevTZ);
                    const d3 = DateTime.fromFormat(correctedFp2, formatString);
                    const dWZone3 = d3.setZone(this.selectedTimeZone);
                    this.fp2 = dWZone3.toLocaleString(DateTime.DATETIME_FULL);

                    correctedFp3 = this.fp3.replace(/\s\S+$/, ' '+prevTZ);
                    const d4 = DateTime.fromFormat(correctedFp3, formatString);
                    const dWZone4 = d4.setZone(this.selectedTimeZone);
                    this.fp4 = dWZone4.toLocaleString(DateTime.DATETIME_FULL);

                    correctedSprint = this.sprint.replace(/\s\S+$/, ' '+prevTZ);
                    const d5 = DateTime.fromFormat(correctedSprint, formatString);
                    const dWZone5 = d5.setZone(this.selectedTimeZone);
                    this.sprint = dWZone5.toLocaleString(DateTime.DATETIME_FULL);
                },
                resetStuff(){
                localStorage.setItem("previousTimeZone", "");
                },
                convertDateForRace(date) {
                    return DateTime.fromISO(date).setZone(this.selectedTimeZone).toLocaleString(DateTime.DATE_FULL);
                },
                convertTimeForRace(date, time) {
                    return DateTime.fromISO(date + "T" + time).setZone(this.selectedTimeZone).toLocaleString(DateTime.TIME_SIMPLE);
                },
                
            },
        });

    </script>
</body>
</html>
